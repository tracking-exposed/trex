<html>
  <head>
    <style>
      body > div {
        padding: 50px;
      }
      #taboule-query-value {
        margin: 0 20px 30px 0;
      }
      #taboule-reload {
        margin-left: 20px;
        cursor: pointer;
      }
    </style>
  </head>
  <body>
    <div>
      <h2>Taboule</h2>
      <div>
        <select id="taboule-query-value">
          <option value="ccRelatedUsers">
            YCAI Content creator Related Users
          </option>
          <option value="personalSearches">Youtube Personal Searches</option>
          <option value="personalVideos">Youtube Personal Videos</option>
          <option value="personalHomes">Youtube Personal Homes</option>
          <option value="personalAds">Youtube Personal ADS</option>
          <option value="getExperimentById">Youtube Compare Experiment</option>
          <option value="getExperimentList">Youtube Experiment list</option>
          <option value="tikTokPersonalHTMLSummary">
            TikTok Personal HTML Summary
          </option>
          <option value="tikTokPersonalSearch">TikTok Personal Search</option>
          <option value="tikTokSearches" selected>
            TikTok (Collective) Searches
          </option>
        </select>
        <div id="taboule-show-inputs" style="display: inline">
          <label>Show Params Inputs</label>
          <input type="checkbox" checked="true" />
        </div>
        <button id="taboule-reload">Reload Taboule</button>
      </div>
      <div id="main"></div>
    </div>
  </body>
  <script type="text/javascript" src="./taboule.js"></script>
  <script type="text/javascript">
    // var baseURL = 'http://localhost:9000/api/';
    var baseURL = 'http://localhost:14000/api/';
    // var baseURL = 'https://tiktok.tracking.exposed/api/';
    // var baseURL = 'https://youtube.tracking.exposed/api/';

    const querySelect = document.querySelector('#taboule-query-value');
    const showInputCheckbox = document.querySelector(
      '#taboule-show-inputs input'
    );
    const tabouleReload = document.querySelector('#taboule-reload');

    const runTaboule = (query, showInput = false) => {
      window.Taboule({
        showInput: showInput,
        node: document.getElementById('main'),
        baseURL: baseURL,
        query: query,
        pageSize: 25,
        initialParams: {
          publicKey: 'H7AsuUszehN4qKTj2GYYwNNzkJVqUQBRo2wgKevzeUwx',
        },
      });
    };

    tabouleReload.addEventListener('click', (e) => {
      runTaboule(
        querySelect.value,
        showInputCheckbox.getAttribute('checked') === 'true'
      );
    });
    querySelect.addEventListener('change', (e) => {
      runTaboule(
        e.target.value,
        showInputCheckbox.getAttribute('checked') === 'true'
      );
    });

    showInputCheckbox.addEventListener('change', (e) => {
      const isChecked = e.currentTarget.getAttribute('checked') === 'true';
      e.currentTarget.setAttribute('checked', isChecked ? 'false' : 'true');
      runTaboule(querySelect.value, !isChecked);
    });

    console.log(
      'show input checked?',
      showInputCheckbox.getAttribute('checked')
    );
    runTaboule(
      querySelect.value,
      showInputCheckbox.getAttribute('checked') === 'true'
    );
  </script>
</html>
